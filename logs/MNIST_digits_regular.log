NUM_EPOCHS = 40
TRAIN_SET_SIZE = 1000
MNIST digits
regular
MNIST_digits_scores_regular_40epoch_1K.png

/Users/oricohen/PycharmProjects/aadam/venv/bin/python "/Applications/PyCharm CE.app/Contents/plugins/python-ce/helpers/pydev/pydevd.py" --multiproc --qt-support=auto --client 127.0.0.1 --port 49859 --file /Users/oricohen/PycharmProjects/aadam/test.py
Connected to pydev debugger (build 211.7628.24)
Iteration 1, loss = 1.70611019
Model Adam Epoch: #1 Test accuracy: 0.86
/Users/oricohen/PycharmProjects/aadam/venv/lib/python3.8/site-packages/scikit_learn-1.2.1-py3.8-macosx-10.12-x86_64.egg/sklearn/neural_network/_multilayer_perceptron.py:702: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (1) reached and the optimization hasn't converged yet.
  warnings.warn(
Iteration 2, loss = 0.57120437
Model Adam Epoch: #2 Test accuracy: 0.945
Iteration 3, loss = 0.18906360
Model Adam Epoch: #3 Test accuracy: 0.97
Iteration 4, loss = 0.10686765
Model Adam Epoch: #4 Test accuracy: 0.955
Iteration 5, loss = 0.05587821
Model Adam Epoch: #5 Test accuracy: 0.975
Iteration 6, loss = 0.05025752
Model Adam Epoch: #6 Test accuracy: 0.965
Iteration 7, loss = 0.02627470
Model Adam Epoch: #7 Test accuracy: 0.975
Iteration 8, loss = 0.02299328
Model Adam Epoch: #8 Test accuracy: 0.945
Iteration 9, loss = 0.01381630
Model Adam Epoch: #9 Test accuracy: 0.98
Iteration 10, loss = 0.00851732
Model Adam Epoch: #10 Test accuracy: 0.955
Iteration 11, loss = 0.00567968
Model Adam Epoch: #11 Test accuracy: 0.965
Iteration 12, loss = 0.00434236
Model Adam Epoch: #12 Test accuracy: 0.95
Iteration 13, loss = 0.00366129
Model Adam Epoch: #13 Test accuracy: 0.965
Iteration 14, loss = 0.00423363
Model Adam Epoch: #14 Test accuracy: 0.955
Iteration 15, loss = 0.00302229
Model Adam Epoch: #15 Test accuracy: 0.965
Iteration 16, loss = 0.00296344
Model Adam Epoch: #16 Test accuracy: 0.965
Iteration 17, loss = 0.00295860
Model Adam Epoch: #17 Test accuracy: 0.97
Iteration 18, loss = 0.00249322
Model Adam Epoch: #18 Test accuracy: 0.965
Iteration 19, loss = 0.00253688
Model Adam Epoch: #19 Test accuracy: 0.975
Iteration 20, loss = 0.00235711
Model Adam Epoch: #20 Test accuracy: 0.97
Iteration 21, loss = 0.00218180
Model Adam Epoch: #21 Test accuracy: 0.97
Iteration 22, loss = 0.00224726
Model Adam Epoch: #22 Test accuracy: 0.98
Iteration 23, loss = 0.00317955
Model Adam Epoch: #23 Test accuracy: 0.965
Iteration 24, loss = 0.00175088
Model Adam Epoch: #24 Test accuracy: 0.975
Iteration 25, loss = 0.00171195
Model Adam Epoch: #25 Test accuracy: 0.98
Iteration 26, loss = 0.00171763
Model Adam Epoch: #26 Test accuracy: 0.98
Iteration 27, loss = 0.00151565
Model Adam Epoch: #27 Test accuracy: 0.975
Iteration 28, loss = 0.00143093
Model Adam Epoch: #28 Test accuracy: 0.98
Iteration 29, loss = 0.00135148
Model Adam Epoch: #29 Test accuracy: 0.97
Iteration 30, loss = 0.00126370
Model Adam Epoch: #30 Test accuracy: 0.97
Iteration 31, loss = 0.00127667
Model Adam Epoch: #31 Test accuracy: 0.975
Iteration 32, loss = 0.00114493
Model Adam Epoch: #32 Test accuracy: 0.98
Iteration 33, loss = 0.00149393
Model Adam Epoch: #33 Test accuracy: 0.98
Iteration 34, loss = 0.00109966
Model Adam Epoch: #34 Test accuracy: 0.975
Iteration 35, loss = 0.00108637
Model Adam Epoch: #35 Test accuracy: 0.985
Iteration 36, loss = 0.00102567
Model Adam Epoch: #36 Test accuracy: 0.975
Iteration 37, loss = 0.00098658
Model Adam Epoch: #37 Test accuracy: 0.975
Iteration 38, loss = 0.00102771
Model Adam Epoch: #38 Test accuracy: 0.98
Iteration 39, loss = 0.00090888
Model Adam Epoch: #39 Test accuracy: 0.975
Iteration 40, loss = 0.00096712
Model Adam Epoch: #40 Test accuracy: 0.98
Iteration 1, loss = 1.88621681
Model Aadam Epoch: #1 Test accuracy: 0.795
/Users/oricohen/PycharmProjects/aadam/venv/lib/python3.8/site-packages/scikit_learn-1.2.1-py3.8-macosx-10.12-x86_64.egg/sklearn/neural_network/_multilayer_perceptron.py:702: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (1) reached and the optimization hasn't converged yet.
  warnings.warn(
Iteration 2, loss = 0.91108504
Model Aadam Epoch: #2 Test accuracy: 0.92
Iteration 3, loss = 0.37859697
Model Aadam Epoch: #3 Test accuracy: 0.95
Iteration 4, loss = 0.19938501
Model Aadam Epoch: #4 Test accuracy: 0.965
Iteration 5, loss = 0.12075020
Model Aadam Epoch: #5 Test accuracy: 0.97
Iteration 6, loss = 0.08053295
Model Aadam Epoch: #6 Test accuracy: 0.975
Iteration 7, loss = 0.05883550
Model Aadam Epoch: #7 Test accuracy: 0.97
Iteration 8, loss = 0.04526043
Model Aadam Epoch: #8 Test accuracy: 0.97
Iteration 9, loss = 0.03491461
Model Aadam Epoch: #9 Test accuracy: 0.975
Iteration 10, loss = 0.02723953
Model Aadam Epoch: #10 Test accuracy: 0.975
Iteration 11, loss = 0.02184508
Model Aadam Epoch: #11 Test accuracy: 0.975
Iteration 12, loss = 0.01806710
Model Aadam Epoch: #12 Test accuracy: 0.975
Iteration 13, loss = 0.01529695
Model Aadam Epoch: #13 Test accuracy: 0.975
Iteration 14, loss = 0.01324753
Model Aadam Epoch: #14 Test accuracy: 0.975
Iteration 15, loss = 0.01167819
Model Aadam Epoch: #15 Test accuracy: 0.975
Iteration 16, loss = 0.01045333
Model Aadam Epoch: #16 Test accuracy: 0.975
Iteration 17, loss = 0.00948416
Model Aadam Epoch: #17 Test accuracy: 0.975
Iteration 18, loss = 0.00870886
Model Aadam Epoch: #18 Test accuracy: 0.975
Iteration 19, loss = 0.00807106
Model Aadam Epoch: #19 Test accuracy: 0.975
Iteration 20, loss = 0.00754626
Model Aadam Epoch: #20 Test accuracy: 0.975
Iteration 21, loss = 0.00710463
Model Aadam Epoch: #21 Test accuracy: 0.975
Iteration 22, loss = 0.00672732
Model Aadam Epoch: #22 Test accuracy: 0.975
Iteration 23, loss = 0.00640774
Model Aadam Epoch: #23 Test accuracy: 0.975
Iteration 24, loss = 0.00612833
Model Aadam Epoch: #24 Test accuracy: 0.975
Iteration 25, loss = 0.00588710
Model Aadam Epoch: #25 Test accuracy: 0.975
Iteration 26, loss = 0.00567421
Model Aadam Epoch: #26 Test accuracy: 0.975
Iteration 27, loss = 0.00548704
Model Aadam Epoch: #27 Test accuracy: 0.975
Iteration 28, loss = 0.00531931
Model Aadam Epoch: #28 Test accuracy: 0.975
Iteration 29, loss = 0.00517052
Model Aadam Epoch: #29 Test accuracy: 0.975
Iteration 30, loss = 0.00503658
Model Aadam Epoch: #30 Test accuracy: 0.975
Iteration 31, loss = 0.00491589
Model Aadam Epoch: #31 Test accuracy: 0.975
Iteration 32, loss = 0.00480672
Model Aadam Epoch: #32 Test accuracy: 0.975
Iteration 33, loss = 0.00470702
Model Aadam Epoch: #33 Test accuracy: 0.975
Iteration 34, loss = 0.00461622
Model Aadam Epoch: #34 Test accuracy: 0.975
Iteration 35, loss = 0.00453322
Model Aadam Epoch: #35 Test accuracy: 0.975
Iteration 36, loss = 0.00445714
Model Aadam Epoch: #36 Test accuracy: 0.975
Iteration 37, loss = 0.00438661
Model Aadam Epoch: #37 Test accuracy: 0.975
Iteration 38, loss = 0.00432165
Model Aadam Epoch: #38 Test accuracy: 0.975
Iteration 39, loss = 0.00426148
Model Aadam Epoch: #39 Test accuracy: 0.975
Iteration 40, loss = 0.00420548
Model Aadam Epoch: #40 Test accuracy: 0.975
Iteration 1, loss = 1.70611019
Model AdamW Epoch: #1 Test accuracy: 0.86
/Users/oricohen/PycharmProjects/aadam/venv/lib/python3.8/site-packages/scikit_learn-1.2.1-py3.8-macosx-10.12-x86_64.egg/sklearn/neural_network/_multilayer_perceptron.py:702: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (1) reached and the optimization hasn't converged yet.
  warnings.warn(
Iteration 2, loss = 0.57120437
Model AdamW Epoch: #2 Test accuracy: 0.945
Iteration 3, loss = 0.18906360
Model AdamW Epoch: #3 Test accuracy: 0.97
Iteration 4, loss = 0.10686765
Model AdamW Epoch: #4 Test accuracy: 0.955
Iteration 5, loss = 0.05587821
Model AdamW Epoch: #5 Test accuracy: 0.975
Iteration 6, loss = 0.05025752
Model AdamW Epoch: #6 Test accuracy: 0.965
Iteration 7, loss = 0.02627470
Model AdamW Epoch: #7 Test accuracy: 0.975
Iteration 8, loss = 0.02299328
Model AdamW Epoch: #8 Test accuracy: 0.945
Iteration 9, loss = 0.01381630
Model AdamW Epoch: #9 Test accuracy: 0.98
Iteration 10, loss = 0.00851732
Model AdamW Epoch: #10 Test accuracy: 0.955
Iteration 11, loss = 0.00567968
Model AdamW Epoch: #11 Test accuracy: 0.965
Iteration 12, loss = 0.00434236
Model AdamW Epoch: #12 Test accuracy: 0.95
Iteration 13, loss = 0.00366129
Model AdamW Epoch: #13 Test accuracy: 0.965
Iteration 14, loss = 0.00423363
Model AdamW Epoch: #14 Test accuracy: 0.955
Iteration 15, loss = 0.00302229
Model AdamW Epoch: #15 Test accuracy: 0.965
Iteration 16, loss = 0.00296344
Model AdamW Epoch: #16 Test accuracy: 0.965
Iteration 17, loss = 0.00295860
Model AdamW Epoch: #17 Test accuracy: 0.97
Iteration 18, loss = 0.00249322
Model AdamW Epoch: #18 Test accuracy: 0.965
Iteration 19, loss = 0.00253688
Model AdamW Epoch: #19 Test accuracy: 0.975
Iteration 20, loss = 0.00235711
Model AdamW Epoch: #20 Test accuracy: 0.97
Iteration 21, loss = 0.00218180
Model AdamW Epoch: #21 Test accuracy: 0.97
Iteration 22, loss = 0.00224726
Model AdamW Epoch: #22 Test accuracy: 0.98
Iteration 23, loss = 0.00317955
Model AdamW Epoch: #23 Test accuracy: 0.965
Iteration 24, loss = 0.00175088
Model AdamW Epoch: #24 Test accuracy: 0.975
Iteration 25, loss = 0.00171195
Model AdamW Epoch: #25 Test accuracy: 0.98
Iteration 26, loss = 0.00171763
Model AdamW Epoch: #26 Test accuracy: 0.98
Iteration 27, loss = 0.00151565
Model AdamW Epoch: #27 Test accuracy: 0.975
Iteration 28, loss = 0.00143093
Model AdamW Epoch: #28 Test accuracy: 0.98
Iteration 29, loss = 0.00135148
Model AdamW Epoch: #29 Test accuracy: 0.97
Iteration 30, loss = 0.00126370
Model AdamW Epoch: #30 Test accuracy: 0.97
Iteration 31, loss = 0.00127667
Model AdamW Epoch: #31 Test accuracy: 0.975
Iteration 32, loss = 0.00114493
Model AdamW Epoch: #32 Test accuracy: 0.98
Iteration 33, loss = 0.00149393
Model AdamW Epoch: #33 Test accuracy: 0.98
Iteration 34, loss = 0.00109966
Model AdamW Epoch: #34 Test accuracy: 0.975
Iteration 35, loss = 0.00108637
Model AdamW Epoch: #35 Test accuracy: 0.985
Iteration 36, loss = 0.00102567
Model AdamW Epoch: #36 Test accuracy: 0.975
Iteration 37, loss = 0.00098658
Model AdamW Epoch: #37 Test accuracy: 0.975
Iteration 38, loss = 0.00102771
Model AdamW Epoch: #38 Test accuracy: 0.98
Iteration 39, loss = 0.00090888
Model AdamW Epoch: #39 Test accuracy: 0.975
Iteration 40, loss = 0.00096712
Model AdamW Epoch: #40 Test accuracy: 0.98
Iteration 1, loss = 2.31179577
Model SGD Epoch: #1 Test accuracy: 0.08
/Users/oricohen/PycharmProjects/aadam/venv/lib/python3.8/site-packages/scikit_learn-1.2.1-py3.8-macosx-10.12-x86_64.egg/sklearn/neural_network/_multilayer_perceptron.py:702: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (1) reached and the optimization hasn't converged yet.
  warnings.warn(
Iteration 2, loss = 2.27966052
Model SGD Epoch: #2 Test accuracy: 0.12
Iteration 3, loss = 2.24860329
Model SGD Epoch: #3 Test accuracy: 0.15
Iteration 4, loss = 2.21837950
Model SGD Epoch: #4 Test accuracy: 0.245
Iteration 5, loss = 2.18881390
Model SGD Epoch: #5 Test accuracy: 0.34
Iteration 6, loss = 2.15970132
Model SGD Epoch: #6 Test accuracy: 0.365
Iteration 7, loss = 2.13079784
Model SGD Epoch: #7 Test accuracy: 0.435
Iteration 8, loss = 2.10206175
Model SGD Epoch: #8 Test accuracy: 0.51
Iteration 9, loss = 2.07338768
Model SGD Epoch: #9 Test accuracy: 0.535
Iteration 10, loss = 2.04478446
Model SGD Epoch: #10 Test accuracy: 0.58
Iteration 11, loss = 2.01618404
Model SGD Epoch: #11 Test accuracy: 0.615
Iteration 12, loss = 1.98755597
Model SGD Epoch: #12 Test accuracy: 0.65
Iteration 13, loss = 1.95875364
Model SGD Epoch: #13 Test accuracy: 0.67
Iteration 14, loss = 1.92976257
Model SGD Epoch: #14 Test accuracy: 0.68
Iteration 15, loss = 1.90069842
Model SGD Epoch: #15 Test accuracy: 0.685
Iteration 16, loss = 1.87133664
Model SGD Epoch: #16 Test accuracy: 0.685
Iteration 17, loss = 1.84180854
Model SGD Epoch: #17 Test accuracy: 0.68
Iteration 18, loss = 1.81209534
Model SGD Epoch: #18 Test accuracy: 0.69
Iteration 19, loss = 1.78221501
Model SGD Epoch: #19 Test accuracy: 0.7
Iteration 20, loss = 1.75209250
Model SGD Epoch: #20 Test accuracy: 0.69
Iteration 21, loss = 1.72175768
Model SGD Epoch: #21 Test accuracy: 0.685
Iteration 22, loss = 1.69131526
Model SGD Epoch: #22 Test accuracy: 0.695
Iteration 23, loss = 1.66078857
Model SGD Epoch: #23 Test accuracy: 0.705
Iteration 24, loss = 1.63023432
Model SGD Epoch: #24 Test accuracy: 0.705
Iteration 25, loss = 1.59965405
Model SGD Epoch: #25 Test accuracy: 0.715
Iteration 26, loss = 1.56910128
Model SGD Epoch: #26 Test accuracy: 0.715
Iteration 27, loss = 1.53862298
Model SGD Epoch: #27 Test accuracy: 0.735
Iteration 28, loss = 1.50824481
Model SGD Epoch: #28 Test accuracy: 0.75
Iteration 29, loss = 1.47799306
Model SGD Epoch: #29 Test accuracy: 0.755
Iteration 30, loss = 1.44786514
Model SGD Epoch: #30 Test accuracy: 0.77
Iteration 31, loss = 1.41784371
Model SGD Epoch: #31 Test accuracy: 0.775
Iteration 32, loss = 1.38801707
Model SGD Epoch: #32 Test accuracy: 0.79
Iteration 33, loss = 1.35845814
Model SGD Epoch: #33 Test accuracy: 0.805
Iteration 34, loss = 1.32928579
Model SGD Epoch: #34 Test accuracy: 0.815
Iteration 35, loss = 1.30049145
Model SGD Epoch: #35 Test accuracy: 0.815
Iteration 36, loss = 1.27206221
Model SGD Epoch: #36 Test accuracy: 0.81
Iteration 37, loss = 1.24409715
Model SGD Epoch: #37 Test accuracy: 0.815
Iteration 38, loss = 1.21661297
Model SGD Epoch: #38 Test accuracy: 0.83
Iteration 39, loss = 1.18957223
Model SGD Epoch: #39 Test accuracy: 0.835
Iteration 40, loss = 1.16301001
Model SGD Epoch: #40 Test accuracy: 0.845
Best Adam test set accuracy: {'best_acc': 0.985} found at epoch #{'best_epoch': 35}
Best Aadam test set accuracy: {'best_acc': 0.975} found at epoch #{'best_epoch': 6}
Best AdamW test set accuracy: {'best_acc': 0.985} found at epoch #{'best_epoch': 35}
Best SGD test set accuracy: {'best_acc': 0.845} found at epoch #{'best_epoch': 40}

Process finished with exit code 0
